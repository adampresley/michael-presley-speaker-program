Rem 10 REM ------ LOUDSPEAKER DESIGN PROGRAMS ------
Rem 15 SCREEN 0
Rem 40 KEY OFF
Rem 45 COLOR 0, 7, 4: CLS
Rem 50 REM DIM I(200)
Rem 60 CLS : LOCATE 3, 25: PRINT "LOUDSPEAKER SYSTEM DESIGN PROGRAMS "
Rem 70 LOCATE 7, 30: PRINT "1) DRIVER PARAMETERS"
Rem 80 LOCATE 8, 30: PRINT "2) VENTED BOX DESIGN"
Rem 90 LOCATE 9, 30: PRINT "3) CLOSED BOX DESIGN"
Rem 100 LOCATE 10, 30: PRINT "4) MAIN MENU"
Rem 110 LOCATE 13, 30: PRINT " YOUR CHOICE ?": LOCATE 13, 45
Rem 120 P$ = INKEY$
Rem 130 IF P$ = "1" THEN 180
Rem 140 IF P$ = "2" THEN 670
Rem 150 IF P$ = "3" THEN 1470
Rem 160 IF P$ = "4" THEN END
Rem 170 GOTO 120
Rem 180 CLS : PRINT TAB(13); "DRIVER PARAMETERS ": PRINT : PRINT
Rem 190 L$ = "N": R$ = "N"
Rem 200 INPUT " ENTER DRIVER NAME "; D$
Rem 210 PRINT
Rem 220 INPUT "   ENTER D.C. RESISTANCE OF VOICE COIL"; RE
Rem 230 PRINT
Rem 240 INPUT "   ENTER FREE-AIR RESONANCE"; FS
Rem 250 PRINT
Rem 260 INPUT "  ENTER IMPEDANCE AT FREE-AIR RESONANCE"; ZMAX
Rem 270 RO = ZMAX / RE
Rem 280 RF = SQR(RO) * RE
Rem 290 PRINT
Rem 300 PRINT "ENTER FREQ. BELOW FREE-AIR ="; RF; " OHMS"
Rem 310 INPUT F1
Rem 320 PRINT
Rem 330 PRINT "ENTER FREQ. ABOVE FREE-AIR ="; RF; "OHMS"
Rem 340 INPUT F2
Rem 350 QMS = FS * SQR(RO) / (F2 - F1)
Rem 360 QES = QMS / (RO - 1)
Rem 370 QTS = QMS * QES / (QMS + QES)
Rem 380 PRINT
Rem 390 INPUT "ENTER TEST BOX VOLUME"; TVB
Rem 400 PRINT
Rem 410 INPUT "ENTER DRIVER RESONANCE IN TEST BOX "; TFS
Rem 420 VAS = TVB * (1.149 * ((TFS / FS) ^ 2 - 1))
Rem 430 CLS : PRINT TAB(13); "DRIVER PARAMETERS": PRINT
Rem 440 PRINT TAB(13); D$: PRINT : PRINT
Rem 450 PRINT "DRIVER 'VAS' ="; INT(VAS * 100) / 100; "CUBIC FEET"
Rem 460 PRINT
Rem 470 PRINT "FREE-AIR RESONANCE (FS) ="; FS; "Hz"
Rem 480 PRINT : PRINT "DRIVER 'QTS' ="; INT(QTS * 100) / 100
Rem 490 PRINT : PRINT " QMS = "; INT(QMS * 100) / 100
Rem 500 PRINT : PRINT " QES = "; INT(QES * 100) / 100
Rem 510 PRINT : PRINT "D.C. VOICE COIL RESISTANCE="; RE; "OHMS"
Rem 520 PRINT : PRINT "Z'="; INT(RF * 100) / 100; "OHMS"
Rem 530 PRINT : PRINT "F1="; F1; "Hz."
Rem 540 PRINT : PRINT "F2="; F2; "Hz."
Rem 550 LOCATE 18, 19
Rem 560 PRINT "TEST BOX VOLUME="; TVB
Rem 570 LOCATE 20, 19
Rem 580 PRINT "DRIVER RESONANCE IN "
Rem 590 LOCATE 21, 19
Rem 600 PRINT "TEST BOX ="; TFS; "Hz."
Rem 610 LOCATE 25, 5
Rem 620 PRINT "ANOTHER DRIVER (Y/N)"
Rem 630 R$ = INKEY$
Rem 640 IF R$ = "Y" THEN 180
Rem 650 IF R$ = "N" THEN 60
Rem 660 GOTO 630
Rem 670 CLS : SCREEN 0: COLOR 0, 7, 4: CLS : LOCATE 2, 29: PRINT "VENTED BOX DESIGN": PRINT : PRINT
Rem 680 L$ = "N"
Rem 690 LOCATE 6, 30: INPUT "DRIVER NAME"; D$
Rem 700 LOCATE 7, 30: INPUT "ENTER QTS"; QTS
Rem 710 LOCATE 8, 30: INPUT "ENTER VAS"; VAS
Rem 720 LOCATE 9, 30: INPUT "ENTER FS"; FS
Rem 730 VB = INT((15 * QTS ^ 2.87 * VAS) * 100) / 100
Rem 740 FB = INT((.42 * QTS ^ -.9 * FS) * 100) / 100
Rem 750 FH = INT((.26 * QTS ^ -1.4 * FS) * 100) / 100
Rem 760 CLS : R$ = "N"
Rem 770 PRINT : PRINT TAB(26); "PARAMETERS FOR A B4-ALIGNMENT":
Rem 780 LOCATE 6, 33: PRINT "VB ="; VB
Rem 790 LOCATE 8, 33: PRINT "FB ="; FB; "Hz"
Rem 800 LOCATE 10, 33: PRINT "F3 ="; FH; "Hz"
Rem 810 H = 0
Rem 820 LOCATE 15, 29: PRINT "CHANGE BOX SIZE (Y/N)"
Rem 825 R$ = INKEY$
Rem 830 IF R$ = "N" OR R$ = "n" THEN 880
Rem 835 IF R$ = "Y" OR R$ = "y" THEN 840
Rem 837 GOTO 825
Rem 840 LOCATE 23, 2: COLOR 7, 0: INPUT "    ENTER NEW VB   ", VB: COLOR 0, 7
Rem 850 FB = INT((FS * (VAS / VB) ^ .32) * 100) / 100
Rem 860 FH = INT((FS * SQR(VAS / VB)) * 100) / 100
Rem 870 Z = 20 * LOG(2.6 * QTS * (VAS / VB) ^ .35) / LOG(10)
Rem 880 CLS : PRINT TAB(31); " VENTED BOX DESIGN"
Rem 890 W = (VB * 1728) ^ (1 / 3)
Rem 900 H = W * 1.62
Rem 910 D = W * .62
Rem 920 S = 1
Rem 930 M = .00037 * VB * (FB ^ 2)
Rem 940 SV = S ^ 2
Rem 950 LV = SV / M - (.83 * SQR(SV))
Rem 960 IF LV < D - 2 THEN S = S + .125: GOTO 940
Rem 970 B$ = "VENT": R$ = "N": L$ = "N"
Rem 980 PRINT TAB(20); D$: PRINT
Rem 990 PRINT TAB(31); "DRIVER PARAMETERS:"
Rem 1000 PRINT TAB(35); "QTS="; QTS
Rem 1010 PRINT TAB(35); "VAS="; VAS
Rem 1020 PRINT TAB(35); "FS="; FS
Rem 1030 PRINT TAB(29); "CALCULATED PARAMETERS:"
Rem 1040 PRINT TAB(35); "VB ="; VB
Rem 1050 PRINT TAB(35); "FB ="; FB; "Hz"
Rem 1060 PRINT TAB(35); "F3 ="; FH; "Hz"
Rem 1070 PRINT TAB(35); "PEAK OR DIP IN RESPONCE ="; Z; "DB"
Rem 1080 PRINT
Rem 1090 PRINT TAB(28); "BOX DIMINSIONS (IN INCHES):"
Rem 1100 PRINT TAB(35); "HEIGHT ="; INT(H * 100) / 100
Rem 1110 PRINT TAB(35); "WIDTH ="; INT(W * 100) / 100
Rem 1120 PRINT TAB(35); "DEPTH ="; INT(D * 100) / 100
Rem 1130 PRINT
Rem 1140 PRINT TAB(32); "VENT DIMINSIONS:"
Rem 1142 PRINT TAB(35); "VENT LENGTH ="; LV; "INCHES"
Rem 1144 PRINT TAB(35); "VENT AREA ="; SV; "SQ.IN."
Rem 1146 PRINT TAB(35); "("; SQR(SV); "IN. x"; SQR(SV); "IN.)"
Rem 1150 LOCATE 23, 2: COLOR 7, 0: PRINT "CHANGE BOX SIZE (Y/N)": COLOR 0, 7
Rem 1155 R$ = INKEY$
Rem 1160 IF R$ = "Y" OR R$ = "y" THEN 840
Rem 1165 IF R$ = "N" OR R$ = "n" THEN 1170
Rem 1167 GOTO 1155
Rem 1170 LOCATE 23, 2: COLOR 7, 0: PRINT "VENTED BOX RESPONCE GRAPH (Y)": COLOR 0, 7
Rem 1175 R$ = INKEY$
Rem 1180 IF R$ = "N" OR R$ = "n" THEN 1210
Rem 1185 IF R$ = "Y" OR R$ = "y" THEN 1190
Rem 1187 GOTO 1175
Rem 1190 GOSUB 2030
Rem 1200 GOTO 1440
Rem 1210 LOCATE 23, 2: COLOR 7, 0: PRINT "    CUSTOM DESIGN (Y/N)      ": COLOR 0, 7
Rem 1215 R$ = INKEY$
Rem 1220 IF R$ = "N" OR R$ = "n" THEN 1440
Rem 1225 IF R$ = "Y" OR R$ = "y" THEN 1230
Rem 1227 GOTO 1215
Rem 1230 CLS : PRINT TAB(28); "CUSTOM VENTED BOX DESIGN"
Rem 1240 B$ = ""
Rem 1250 LOCATE 8, 32: COLOR 7, 0: PRINT "CHANGE VB (Y/N)": COLOR 0, 7
Rem 1255 R$ = INKEY$
Rem 1260 IF R$ = "N" OR R$ = "n" THEN 1290
Rem 1265 IF R$ = "Y" OR R$ = "y" THEN 1270
Rem 1267 GOTO 1255
Rem 1270 LOCATE 8, 32: COLOR 7, 0: INPUT " ENTER NEW VB"; VB: COLOR 0, 7
Rem 1290 LOCATE 8, 28: COLOR 7, 0: PRINT "CHANGE BOX TUNING (Y/N)": COLOR 0, 7
Rem 1295 R$ = INKEY$
Rem 1300 IF R$ = "N" OR R$ = "n" THEN 850
Rem 1305 IF R$ = "Y" OR R$ = "y" THEN 1310
Rem 1307 GOTO 1295
Rem 1310 LOCATE 8, 28: COLOR 7, 0: INPUT "    ENTER NEW FB     "; FB: COLOR 0, 7
Rem 1320 GOSUB 2030
Rem 1330 IF B$ = "VENT" THEN 880
Rem 1340 CLS : PRINT TAB(28); "CUSTOM VENTED BOX DESIGN"
Rem 1350 R$ = "N"
Rem 1360 PRINT : PRINT : PRINT D$
Rem 1370 PRINT TAB(33); "VB ="; VB
Rem 1380 PRINT TAB(33); "FB ="; FB; "Hz"
Rem 1390 PRINT TAB(33); "QTS ="; QTS
Rem 1400 PRINT TAB(33); "FS ="; FS; "Hz"
Rem 1410 PRINT TAB(33); "VAS ="; VAS
Rem 1420 PRINT : PRINT : PRINT "CHANGE VB OR FB (Y/N)"
Rem 1425 L$ = INKEY$
Rem 1430 IF L$ = "Y" OR L$ = "y" THEN 1230
Rem 1435 IF L$ = "n" OR L$ = "N" THEN 1440
Rem 1437 GOTO 1425
Rem 1440 LOCATE 23, 1: COLOR 7, 0: PRINT "ANOTHER VENTED BOX DESIGN (Y/N)": COLOR 0, 7
Rem 1445 R$ = INKEY$
Rem 1450 IF R$ = "Y" OR R$ = "y" THEN 670
Rem 1455 IF R$ = "N" OR R$ = "n" THEN 1460
Rem 1457 GOTO 1445
Rem 1460 GOTO 15
Rem 1470 CLS : SCREEN 0: COLOR 0, 7, 4: CLS : PRINT TAB(31); "CLOSED BOX DESIGN": PRINT : PRINT
Rem 1480 L$ = "N": R$ = "N": B$ = ""
Rem 1490 LOCATE 5, 30: INPUT "DRIVER NAME"; D$
Rem 1500  LOCATE 6, 30: INPUT "ENTER QTS"; QTS
Rem 1510 LOCATE 7, 30: INPUT "ENTER VAS"; VAS
Rem 1520 LOCATE 8, 30: INPUT "ENTER FS"; FS
Rem 1530 GOTO 1590
Rem 1540 A = VAS / VB
Rem 1550 FC = FS * SQR(A + 1)
Rem 1560 QTC = (FC * QTS) / FS
Rem 1570 F3 = FC * SQR(((1 / QTC ^ 2 - 2) + SQR((1 / QTC ^ 2 - 2) ^ 2 + 4)) / 2)
Rem 1580 GOTO 1750
Rem 1590 CLS : LOCATE 2, 31: PRINT "CLOSED BOX DESIGN"
Rem 1600 Q1 = 1 / QTS
Rem 1610 Q2 = (Q1 ^ 2) - 1
Rem 1620 VB = VAS / Q2
Rem 1630 FC = FS * Q1
Rem 1640 F3 = FC * .79
Rem 1650 QTC = (FC * QTS) / FS
Rem 1660 REM R$="N"
Rem 1670 PRINT : PRINT D$: PRINT : PRINT
Rem 1680 PRINT TAB(30); "F3 ="; F3; "Hz"
Rem 1690 PRINT TAB(30); "QTC ="; QTC
Rem 1700 PRINT TAB(30); "VB ="; VB
Rem 1710 LOCATE 13, 30: COLOR 7, 0: PRINT "CHANGE BOX SIZE (Y/N)": COLOR 0, 7: LOCATE 13, 52
Rem 1715 R$ = INKEY$
Rem 1720 IF R$ = "N" OR R$ = "n" THEN 1750
Rem 1725 IF R$ = "Y" OR R$ = "y" THEN 1730
Rem 1727 GOTO 1715
Rem 1730 LOCATE 13, 30: COLOR 7, 0: INPUT "    ENTER NEW VB    "; VB: COLOR 0, 7: LOCATE 13, 52
Rem 1740 GOTO 1540
Rem 1750 CLS : PRINT TAB(29); "CLOSED BOX DESIGN"
Rem 1760  REM R$="N" : L$="N"
Rem 1770 W = (VB * 1728) ^ (1 / 3)
Rem 1780 H = W * 1.62
Rem 1790 D = W * .62
Rem 1800 PRINT : PRINT TAB(13); D$: PRINT
Rem 1810 PRINT TAB(29); "MEASURED PARAMETERS:"
Rem 1812 PRINT TAB(30); "QTS ="; QTS
Rem 1814 PRINT TAB(30); "VAS ="; VAS; "cu.ft."
Rem 1816 PRINT TAB(30); "FS ="; FS; "Hz"
Rem 1818 PRINT : PRINT TAB(29); "CALCULATED PARAMETERS:"
Rem 1820 PRINT TAB(30); "VB ="; VB; "cu.ft."
Rem 1822 PRINT TAB(30); "QTC ="; QTC
Rem 1824 PRINT TAB(30); "FC ="; FC; "Hz"
Rem 1826 PRINT TAB(30); "F3 ="; F3; "Hz"
Rem 1890 PRINT
Rem 1900 PRINT TAB(10); "FOR A BOX THIS SIZE, THE DIMINSIONS (IN INCHES) WILL BE:"
Rem 1910 LOCATE 17, 30: PRINT "HEIGHT ="; H
Rem 1920 PRINT TAB(30); "WIDTH ="; W
Rem 1930 PRINT TAB(30); "DEPTH ="; D
Rem 1940 LOCATE 23, 21: COLOR 7, 0: PRINT "CLOSED BOX RESPONCE GRAPH (Y/N)": COLOR 0, 7: LOCATE 23, 53
Rem 1945 R$ = INKEY$
Rem 1950 IF R$ = "N" OR R$ = "n" THEN 1990
Rem 1960 IF R$ = "Y" OR R$ = "y" THEN 1980
Rem 1965 GOTO 1945
Rem 1980 GOSUB 2030
Rem 1990 REM R$="N"
Rem 2000 CLS : LOCATE 12, 24: COLOR 7, 0: PRINT "ANOTHER CLOSED BOX DESIGN (Y/N)": COLOR 0, 7: LOCATE 12, 55
Rem 2005 R$ = INKEY$
Rem 2010 IF R$ = "Y" OR R$ = "y" THEN 1470
Rem 2015 IF R$ = "N" OR R$ = "n" THEN 2020
Rem 2017 GOTO 2005
Rem 2020 GOTO 15
Rem 2030 REM ------ GRAPH PLOTTER  POINT TO POINT GRAPH
Rem 2040 SCREEN 2
Rem 2050 XAT$ = "FREQUENCY (Hz)"
Rem 2060 XAT$ = LEFT$(XAT$, 50)
Rem 2070 YAT1$ = "RESPONCE"
Rem 2080 YAT2$ = LEFT$(YAT2$, 10)
Rem 2090 YAT2$ = " IN DB"
Rem 2100 YAT2$ = LEFT$(YAT2$, 10)
Rem 2110 LY = -10
Rem 2120 HY = 10
Rem 2130 LX = 0
Rem 2140 HX = 105
Rem 2150 XD = 10
Rem 2160 YD = 1
Rem 2170 CLS
Rem 2180 LOCATE 9, 2: PRINT YAT1$;
Rem 2190 LOCATE 10, 2: PRINT YAT2$;
Rem 2200 LOCATE 11, 1: PRINT YAT3$;
Rem 2210 LOCATE 23, (63 - LEN(XAT$)) / 2 + 17: PRINT XAT$;
Rem 2220 LOCATE 25, (80 - LEN(MT$)) / 2: PRINT MT$;
Rem 2230 WINDOW (LX - ((HX - LX) * .2046875), LY - ((HY - LY) * .225))-(HX, HY)
Rem 2240 LINE (LX, LY)-(HX, LY)
Rem 2250 LINE (LX, HY)-(LX, LY)
Rem 2260 TICXL = (HX - LX) * .015
Rem 2270 TICYL = (HY - LY) * .015
Rem 2280 FOR X = LX TO HX STEP XD
Rem 2290    LINE (X, LY + TICYL)-(X, LY - TICYL)
Rem 2300    XTP = PMAP(X, 0): LOCATE 22, (XTP / 640) * 80: IF POS(0) < 78 THEN PRINT USING "###"; X;
Rem 2310 NEXT X
Rem 2320 FOR Y = LY TO HY STEP YD
Rem 2330    LINE (LX - TICXL, Y)-(LX + TICXL, Y)
Rem 2340 YTP = PMAP(Y, 1): LOCATE (YTP / 200) * 25 + 1, 10: PRINT USING "###"; Y;
Rem 2350 NEXT Y
Rem 2355 LOCATE 1, 20: PRINT D$
Rem 2357 LOCATE 2, 20: PRINT "Vas ="; VAS; "ft^3": LOCATE 2, 40: PRINT "Qts ="; QTS: LOCATE 2, 60: PRINT "Fs ="; FS; "Hz"
Rem 2358 LOCATE 3, 20: PRINT "Vb ="; VB; "ft^3": LOCATE 3, 40: PRINT "-3dB ="; FH; "Hz": IF B$ = "VENT" THEN LOCATE 3, 60: PRINT "Fb ="; FB; "Hz" ELSE LOCATE 3, 60: PRINT "Qtc ="; QTC
Rem 2360 DIM F(200), PNTY(200)
Rem 2370 I = 1
Rem 2380 A = (FB ^ 2) / (FS ^ 2)
Rem 2390 B = A / QTS + (FB / (7 * FS))
Rem 2400 C = 1 + A + (FB / (7 * FS * QTS)) + (VAS / VB)
Rem 2410 D = 1 / QTS + (FB / (7 * FS))
Rem 2420 FOR F = 10 TO 105 STEP 5
Rem 2430 F9 = F / FS: F5 = F9 ^ 2
Rem 2440 F4 = F9 ^ 4: F3 = F9 ^ 3
Rem 2450 F6 = (F4 - C * F5 + A) ^ 2
Rem 2460 F7 = (B * F9 - D * F3) ^ 2
Rem 2470 PNTY(I) = 20 * (LOG(F4 / (F6 + F7) ^ .5) / LOG(10))
Rem 2480 F(I) = F * 1
Rem 2490 I = I + 1
Rem 2500 NEXT F
Rem 2510 SWAPF = 0
Rem 2520 FOR J = 1 TO I - 2
Rem 2530 IF F(J + 1) > F(J) THEN SWAP F(J + 1), F(J): SWAP PNTY(J + 1), PNTY(J): SWAPF = 1
Rem 2540 NEXT J
Rem 2550 IF SWAPF = 1 THEN 2510
Rem 2560 PSET (F(1), PNTY(1))
Rem 2570 FOR J = 2 TO I - 1
Rem 2580 LINE -(F(J), PNTY(J))
Rem 2590 NEXT J
Rem 2600 ERASE F
Rem 2610 ERASE PNTY
Rem 2620 LOCATE 25, 20
Rem 2630 PRINT "PRESS 'P' TO PRINT GRAPH, 'C' TO CONTINUE"
Rem 2640 R$ = INKEY$
Rem 2650 IF R$ = "P" OR R$ = "p" THEN 2660
Rem 2655 IF R$ = "C" OR R$ = "c" THEN 2690
Rem 2657 GOTO 2640
Rem 2660 LOCATE 25, 20
Rem 2670 PRINT "                                                 "
Rem 2680 R$ = INKEY$: IF R$ <> "" THEN 2680
Rem 2682 R$ = INKEY$: IF R$ = "" THEN 2682
Rem 2684 GOTO 2620
Rem 2690 CLS : SCREEN 0: COLOR 0, 7
Rem 2700 RETURN

